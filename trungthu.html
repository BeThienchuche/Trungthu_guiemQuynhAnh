<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trung Thu</title>
 

  <style>
    :root {
      --accent: #ff7f50;
      --accent-2: #ff5722;
      --text-color: #ffd98a;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: "Inter", "Segoe UI", system-ui, sans-serif;
      background: #060614;
      overflow: hidden;
    }

    .stage {
      position: relative;
      min-height: 100vh;
    }

    canvas#starfield {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* --- M·∫∑t trƒÉng --- */
    .moon {
      position: fixed;
      top: 40px;
      right: 60px;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background:
        radial-gradient(circle at 30% 30%, #fff 0%, #fffbe6 45%, #ffe9a8 100%),
        repeating-radial-gradient(circle at 60% 60%, rgba(220,200,120,0.12) 0px, rgba(220,200,120,0.12) 8px, transparent 12px, transparent 20px);
      box-shadow:
        0 0 40px 20px rgba(255, 230, 120, 0.55),
        0 0 80px 40px rgba(255, 220, 80, 0.25),
        0 0 30px rgba(255, 255, 210, 0.7),
        0 0 60px rgba(255, 240, 200, 0.4);
      pointer-events: none;
      z-index: 2;
    }

    /* --- ƒê√®n l·ªìng --- */
    #lantern-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 10;
    }

    .lantern {
      position: absolute;
      width: 40px;
      user-select: none;
      pointer-events: auto;
    }

    @keyframes swing {
      0%, 100% { transform: rotate(-5deg); }
      50% { transform: rotate(5deg); }
    }

    .swing {
      animation: swing 2s ease-in-out infinite;
    }

    /* --- Popup l·ªùi ch√∫c --- */
    /* üå∏ Font Google */
   @import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Mali:wght@500;700&display=swap');
    #wish-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.96);
     color: #f47c1f; 
      font-weight: 600;
      padding: 45px 50px;
      border-radius: 18px;
      display: none;
      z-index: 9999;
      box-shadow: 0 6px 30px rgba(243, 238, 238, 0.35);
      text-align: center;
      max-width: 90%;
     font-size: 24px; /* üëà to h∆°n */
     font-family: "Pacifico", "Mali", cursive;
     box-shadow:
    0 0 10px rgba(255, 200, 120, 0.6),
    0 0 30px rgba(255, 180, 90, 0.4),
    0 0 50px rgba(255, 160, 60, 0.3);

  /* Animation khi popup xu·∫•t hi·ªán */
  animation: popupShow 0.6s ease forwards;
    }

    /* --- G·ª£i √Ω ch·∫°m m√†n h√¨nh --- */
    #hint {
      position: fixed;
      bottom: 8vh;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 14px;
      background: linear-gradient(90deg, rgba(51, 51, 50, 0.95), rgba(167, 69, 69, 0.95));
      color: #fff;
      border-radius: 999px;
      font-weight: 600;
      z-index: 9998;
      opacity: 0;
      transition: opacity .35s ease;
      pointer-events: none;
    }

    /* --- Hi·ªáu ·ª©ng ch·ªØ Dream Fade --- */
.text-wrapper {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  max-width: 900px;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  overflow: visible;
  z-index: 99999;
  padding: 6vh 4vw;
  box-sizing: border-box;
}

.line {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  white-space: normal;
  display: flex;
  gap: 4px;
  justify-content: center;
  align-items: center;
  font-family: "Mali", cursive;
  font-size: clamp(1rem, 4vw, 2.2rem); /* <-- t·ª± ƒë·ªông co ch·ªØ theo m√†n h√¨nh */
  color: rgb(224, 132, 12);
  text-shadow:
   0 0 4px rgba(240, 150, 16, 0.9),
    0 0 12px rgba(230, 229, 227, 0.12),
    0 2px 20px rgba(0, 0, 0, 0.6);
  opacity: 0;
  transition: opacity 220ms linear;
  text-align: center;
}

.line.active {
  opacity: 1;
}

@media (max-width: 480px) {
  .text-wrapper {
    transform: translate(-50%, -50%) scale(0.85);
  }
}

    .char {
      display: inline-block;
      opacity: 0;
      transform: translateY(8px);
      filter: blur(8px);
      transition: transform 320ms cubic-bezier(.2, .9, .2, 1), opacity 320ms ease, filter 320ms ease;
      will-change: transform, opacity, filter;
    }

    .char.show {
      opacity: 1;
      transform: translateY(0);
      filter: blur(0);
    }

    .char.hide {
      opacity: 0;
      transform: translateY(-8px);
      filter: blur(8px);
    }

    .shine {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 120%;
      height: 40%;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 0;
      transition: opacity 300ms ease;
      border-radius: 20px;
    }

    .controls {
      position: fixed;
      left: 18px;
      top: 18px;
      z-index: 10;
      color: #fff;
      font-size: 14px;
    }

    .music-toggle {
      cursor: pointer;
    }

    @media (max-width:600px) {
      .moon {
        top: 14px;
        right: 14px;
        width: 70px;
        height: 70px;
      }

     
      #hint { font-size: 0.9rem; }
    }
/* --- Popup ƒë·ªìng √Ω --- */
 #popup {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.65);
  backdrop-filter: blur(6px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  transition: opacity 0.5s ease;
  animation: fadeIn 0.8s ease forwards;
    }

.popup-content {
  background: linear-gradient(135deg, #fffaf0, #ffe4b5);
  padding: 60px 30px;
  border-radius: 22px;
  text-align: center;
  box-shadow: 0 0 25px rgba(255, 200, 120, 0.7), 0 0 60px rgba(255, 150, 80, 0.4);
  transform: scale(0.8);
  animation: popupShow 0.7s ease forwards;
  position: relative;
  max-width: 90%;
  width: 800px;
    }

.popup-content p {  font-size: 1.6rem;
  font-weight: 600;
  color: #d14f00;
  margin-bottom: 45px;
  text-shadow: 0 0 8px rgba(255, 215, 150, 0.7);}

.popup-content button {
  font-size: 1.05rem;
  padding: 10px 22px;
  border: none;
  border-radius: 25px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
    }

   .buttons {
  display: flex;
  justify-content: center;
  gap: 30px; /* üëà kho·∫£ng c√°ch gi·ªØa 2 n√∫t, c√≥ th·ªÉ ch·ªânh 20‚Äì40px t√πy b·∫°n */
} 

 #yesBtn { background: linear-gradient(45deg, #ff9f68, #ff7f50);
  color: white;
  box-shadow: 0 0 15px rgba(243, 67, 3, 0.6); }

 #noBtn {  background: #f0d9b3;
  color: #6b3d00;
  box-shadow: 0 0 10px rgba(228, 71, 9, 0.5);
  transform: scale(0.95);
}

    /* --- Th√¥ng b√°o d∆∞·ªõi --- */
    #bottomMessage {
      position: fixed; 
      bottom: 250px; left: 50%;
      transform: translateX(-50%);
      padding: 10px 25px; border-radius: 20px;
      font-size: 1.8rem; 
      color: #fff8c4;;
      font-weight: bold;
      text-align: center; /* CƒÉn gi·ªØa */
      white-space: normal; /* Cho ph√©p xu·ªëng d√≤ng t·ª± nhi√™n */
      word-wrap: break-word; /* T·ª± ng·∫Øt t·ª´ n·∫øu qu√° d√†i */
      text-shadow: 
    0 0 20px #ffd966;
      opacity: 0; 
      transition: opacity 0.8s ease; 
      z-index: 999;
    }
    #marqueeMessage {
      position: fixed; bottom: 10px; 
      width: 100%; 
      text-align: center;
      font-size: 1rem; color: #fff; 
      background: rgba(240, 233, 203, 0.6);
      padding: 5px 0; 
      overflow: hidden; 
      display: none; 
      white-space: nowrap;
    }
    #marqueeMessage span {
      display: inline-block;
      animation: marquee 10s linear forwards;
    }
    @keyframes marquee {
      from { transform: translateX(100%); }
      to { transform: translateX(-100%); }
    }

    #coupleImage {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px; 
  opacity: 0.95;
  z-index: 999;
  pointer-events: none;
  animation: gentleSwing 4s ease-in-out infinite;
}

/* Hi·ªáu ·ª©ng lung lay nh·∫π sang hai b√™n */
@keyframes gentleSwing {
  0%, 100% {
    transform: translateX(-50%) rotate(0deg);
  }
  25% {
    transform: translateX(calc(-50% - 3px)) rotate(-2deg);
  }
  75% {
    transform: translateX(calc(-50% + 3px)) rotate(2deg);
  }
}

  </style>
</head>

<body>
  <div class="stage">
    <canvas id="starfield"></canvas>
    <div class="moon"></div>
    <div id="lantern-container"></div>
    <div id="wish-popup"></div>
    <div id="hint">Ch·∫°m m√†n h√¨nh ƒë·ªÉ m·ªü nh·∫°c nha üíï</div>
    <div class="controls">
      <span id="musicToggle" class="music-toggle"></span>
    </div>

    <!-- üî• Ph·∫ßn ch·ªØ ƒë·ªông Dream Fade -->
    <div class="text-wrapper" id="textWrapper">
      <div class="shine" id="shine"></div>
    </div>
  </div>
<!--img ·∫£nh-->
<img id="coupleImage" src="a.png" alt="C·∫∑p ƒë√¥i ng·∫Øm trƒÉng">
  <!-- Popup -->
  <div id="popup">
    <div class="popup-content">
      <p>Em c√≥ ƒë·ªìng √Ω ng·∫Øm trƒÉng v√† ∆∞·ªõc nguy·ªán ƒë√®n tr·ªùi c√πng anh ko ?</p>
      <div class="buttons">
        <button id="yesBtn">C√≥ üíñ</button>
        <button id="noBtn">Kh√¥ng üò¢</button>
      </div>
    </div>
  </div>

  <div id="bottomMessage"></div>
  <div id="marqueeMessage"></div>

     <!--Nh·∫°c n·ªÅn-->   
  <audio id="bg-music" loop>
    <source src="ngamtrangdanlencao.mp3" type="audio/mp3">
  </audio>

  <script>
 let allowLanternClick = false; // üö´ ban ƒë·∫ßu ch∆∞a cho b·∫•m ƒë√®n l·ªìng
  
/* === Hi·ªáu ·ª©ng sao === */
const canvas = document.getElementById('starfield');
const ctx = canvas.getContext('2d');
let w, h, stars = [];

function resizeCanvas() {
  w = canvas.width = innerWidth;
  h = canvas.height = innerHeight;
  stars = [];
  const count = Math.round((w * h) / 2200);
  for (let i = 0; i < count; i++) {
    stars.push({
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 0.9 + 0.1,
      a: Math.random() * 0.8 + 0.2
    });
  }
}
function drawStars() {
  ctx.clearRect(0, 0, w, h);
  for (const s of stars) {
    ctx.globalAlpha = s.a;
    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    ctx.fill();
  }
  ctx.globalAlpha = 1;
}
function loop() {
  drawStars();
  requestAnimationFrame(loop);
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);
loop();

/* === ƒê√®n l·ªìng === */
const lanternContainer = document.getElementById('lantern-container');
const wishes = [
  "Em h√£y c∆∞·ªùi nhi·ªÅu l√™n nh√©, em xinh l·∫Øm ƒë√≥!",
  "Mong em lu√¥n g·∫∑p nhi·ªÅu ni·ªÅm vui trong cu·ªôc s·ªëng.",
  "Ch√∫c em c√≥ m·ªôt m√πa trung thu vui v·∫ª, h·∫°nh ph√∫c khi c√≥ anh!",
  "C√≥ em c·∫°nh b√™n, m√πa trƒÉng n√†o c≈©ng th·∫≠t ƒë·∫∑c bi·ªát.",
  "∆Ø·ªõc m∆° c·ªßa em s·∫Ω th√†nh hi·ªán th·ª±c theo nh·ªØng chi·∫øc ƒë√®n l·ªìng ƒëang bay n√†y.",
  "Trung thu vui v·∫ª nh√©, ng∆∞·ªùi anh th∆∞∆°ng nh·ªõ r·∫•t nhi·ªÅu!",
  "ƒê√™m trƒÉng r·∫±m th·∫≠t ·∫•m √°p v√† h·∫°nh ph√∫c khi c√≥ em ."
];

function createLantern() {
  const lantern = document.createElement("img");
  lantern.src = "dentroixp.png";// ƒë√®n
  lantern.className = "lantern swing";

  const size = 30 + Math.random() * 40;
  const duration = 10000 + Math.random() * 4000;
  const opacity = 0.6 + Math.random() * 0.4;
  lantern.style.width = size + "px";
  lantern.style.left = Math.random() * 90 + "vw";
  lantern.style.bottom = "0px";
  lantern.style.opacity = opacity;
  lanternContainer.appendChild(lantern);

  const drift = Math.random() * 140 - 70;
  const up = 120 + Math.random() * 40;

  lantern.animate([
    { transform: "translate(0,0)", opacity },
    { transform: `translate(${drift}px, -${up}vh)`, opacity: 0 }
  ], { duration, easing: "linear", fill: "forwards" });

  setTimeout(() => lantern.remove(), duration);

  lantern.addEventListener("click", (e) => {
     if (!allowLanternClick) return; // üö´ Ch∆∞a ƒë∆∞·ª£c ph√©p th√¨ kh√¥ng l√†m g√¨ c·∫£
    e.stopPropagation();
    const popup = document.getElementById('wish-popup');
    popup.textContent = wishes[Math.floor(Math.random() * wishes.length)];
    popup.style.display = 'block';
  });
}
setInterval(createLantern, 500);

/* === Nh·∫°c === */
const bg = document.getElementById('bg-music');
const musicToggle = document.getElementById('musicToggle');
let started = false;
function startMusic() {
  if (started) return;
  bg.volume = 0;
  bg.play().then(() => {
    started = true;
    let v = 0;
    const fade = setInterval(() => {
      v += 0.05;
      if (v >= 0.9) clearInterval(fade);
      bg.volume = Math.min(v, 0.9);
    }, 120);
    musicToggle.textContent = 'üé∂';
    const hint = document.getElementById('hint');
    hint.style.opacity = '1';
    setTimeout(() => hint.style.opacity = '0', 1800);
  }).catch(() => {});
}
musicToggle.addEventListener('click', (e) => {
  e.stopPropagation();
  if (!started) { startMusic(); return; }
  if (bg.paused) { bg.play(); musicToggle.textContent = 'üé∂'; }
  else { bg.pause(); musicToggle.textContent = 'üîà'; }
});
document.addEventListener('pointerdown', function once() {
  startMusic();
  document.removeEventListener('pointerdown', once);
});
document.addEventListener('click', () => {
  const pop = document.getElementById('wish-popup');
  if (pop.style.display === 'block') pop.style.display = 'none';
});

/* === Hi·ªáu ·ª©ng ch·ªØ Dream Fade === */
const LINES = ["Em ∆°i, ƒê√™m nay l√† Trung thu r·ªìi ƒë√≥ ü•∞",
                "NƒÉm n√†o trƒÉng c≈©ng tr√≤n v√† ƒë·∫πp nh·ªâ, lu√¥n r·∫°ng r·ª° nh∆∞ n·ª• c∆∞·ªùi c·ªßa em v·∫≠y ƒë√≥.",
                "ƒê√™m nay th·∫≠t ƒë·∫∑c bi·ªát gh√™, c√≥ anh, c√≥ em ,c√≥ trƒÉng ,v√† c√≥ ƒë√®n tr·ªùi.",
                "ƒê√™m nay ƒëc ng·∫Øm trƒÉng, ng·∫Øm ƒë√®n tr·ªùi v·ªõi em th√¨ c√≤n g√¨ tuy·ªát v·ªùi h∆°n n·ªØa hen!",
                "T·ª•i m√¨nh c√πng nhau g·ª≠i nh·ªØng l·ªùi ∆∞·ªõc nguy·ªán nho nh·ªè cho t∆∞∆°ng lai nha.",
                "Kh√¥ng c·∫ßn g√¨ to t√°t, ch·ªâ c·∫ßn c√≥ em b√™n c·∫°nh, ƒë√™m trƒÉng n√†o c≈©ng ƒë·ªß ·∫•m √°p r·ªìi."
];
const wrapper = document.getElementById('textWrapper');
const shine = document.getElementById('shine');

function createLines(lines) {
  for (const txt of lines) {
    const line = document.createElement('div');
    line.className = 'line';
    for (const ch of txt) {
      const sp = document.createElement('span');
      sp.className = 'char';
      sp.textContent = ch;
      line.appendChild(sp);
    }
    wrapper.appendChild(line);
  }
}
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
async function showLine(line, charDelay = 60) {
  line.classList.add('active');
  await new Promise(r => requestAnimationFrame(r));
  const chars = Array.from(line.querySelectorAll('.char'));
  for (let i = 0; i < chars.length; i++) {
    chars[i].classList.remove('hide');
    chars[i].classList.add('show');
    await sleep(charDelay);
  }
}
async function hideLine(line, charDelay = 45) {
  const chars = Array.from(line.querySelectorAll('.char'));
  for (let i = chars.length - 1; i >= 0; i--) {
    chars[i].classList.remove('show');
    chars[i].classList.add('hide');
    await sleep(charDelay);
  }
  await sleep(220);
  line.classList.remove('active');
  chars.forEach(c => c.classList.remove('hide'));
}

/* === Popup logic === */
const popup = document.getElementById('popup');
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const bottomMessage = document.getElementById('bottomMessage');
const marqueeMessage = document.getElementById('marqueeMessage');
const noTexts = ["ƒêi m√† ü•∫","Em ch·∫Øc ch∆∞a üò¢","ƒêi ƒëi m√† üò≠","Th·∫≠t lu√¥n ƒë√≥ üò©","Cho anh c∆° h·ªôi ƒëi üò≠"];
let noIndex = 0;

function showPopup() {
  popup.style.display = 'flex';
  popup.style.opacity = '1';
}

// Khi b·∫•m "Kh√¥ng üò¢"
noBtn.addEventListener('click', () => {
  noBtn.textContent = noTexts[noIndex];
  noIndex = (noIndex + 1) % noTexts.length;
});

// Khi b·∫•m "C√≥ üíñ"
yesBtn.addEventListener('click', () => {
  popup.style.transition = 'opacity 0.6s ease';
  popup.style.opacity = '0';
  setTimeout(() => {
    popup.style.display = 'none';
  }, 600);

  bottomMessage.textContent = "Anh bi·∫øt em s·∫Ω ƒë·ªìng √Ω m√† üíï";
  bottomMessage.style.opacity = '1';
  setTimeout(() => bottomMessage.style.opacity = '0', 4000);

  // üïí Sau 4s hi·ªán ch·ªØ ch·∫°y
  setTimeout(() => {
    marqueeMessage.style.display = 'block';
    marqueeMessage.innerHTML = `<span>üí° ·∫§n v√†o ƒë√®n l·ªìng s·∫Ω c√≥ ƒëi·ªÅu b·∫•t ng·ªù nha em y√™u ‚ù§Ô∏è</span>`;
    allowLanternClick = true; // ‚úÖ Cho ph√©p b·∫•m ƒë√®n l·ªìng
    setTimeout(() => {
      marqueeMessage.style.display = 'none';
    }, 9000);
  }, 3500);
});


/* === Dream Loop === */
async function dreamLoop() {
  const lines = Array.from(wrapper.querySelectorAll('.line'));
  if (lines.length === 0) return;
  await sleep(200);
  let shown = false; // ‚úÖ Khai b√°o bi·∫øn ƒë√∫ng ch·ªó
  while (!shown) {
    for (const line of lines) {
      shine.style.opacity = '0.18';
      await showLine(line, 70);
      shine.style.opacity = '0';
      await sleep(1600);
      await hideLine(line, 55);
      await sleep(260);
    }
    wrapper.style.display = 'none';
    shine.style.display = 'none';
    await sleep(1800); // ‚è± ch·ªù 1,8s r·ªìi m·ªõi b·∫≠t popup
    showPopup();
    shown = true; // ‚úÖ Ch·ªâ hi·ªán popup 1 l·∫ßn
  }
}

createLines(LINES);
dreamLoop();

    
  </script>
</body>
</html>
